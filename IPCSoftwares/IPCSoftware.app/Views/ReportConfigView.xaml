<UserControl x:Class="IPCSoftware.App.Views.ReportConfigView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:helpers="clr-namespace:IPCSoftware.App.Helpers"
    Background="#F3F3F3">
    <UserControl.Resources>
        <helpers:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </UserControl.Resources>
    <Grid Margin="40">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*" />
            <ColumnDefinition Width="2*" />
            <ColumnDefinition Width="2*" />
        </Grid.ColumnDefinitions>

        <!-- Left: Saved Reports -->
        <Border Grid.Column="0" Background="White" Padding="20" CornerRadius="10">
            <StackPanel>
                <TextBlock Text="Saved Reports" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>
                <ListBox ItemsSource="{Binding ReportFormats}" SelectedItem="{Binding SelectedFormat}" DisplayMemberPath="Name" Height="250"/>
                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                    <Button Content="Delete" Command="{Binding DeleteCommand}" Width="80" Margin="0,0,10,0"/>
                    <!--<Button Content="Edit" Command="{Binding EditCommand}" Width="80"/>-->
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Middle: New Report Creation -->
        <Border Grid.Column="1" Background="White" Padding="20" CornerRadius="10">
            <StackPanel>
                <TextBlock Text="New Report" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>
                <TextBox Text="{Binding ReportName, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,10"/>
                <TextBlock Text="Columns for Selection" FontSize="16" Margin="0,0,0,10"/>
                <ListBox ItemsSource="{Binding AvailableColumns}" SelectionMode="Multiple"
                         helpers:ListBoxSelectedItemsBehavior.BindableSelectedItems="{Binding SelectedColumns, Mode=TwoWay}" Height="250">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="30"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0"
                                           Text="✔"
                                           Foreground="#1976D2"
                                           FontSize="16"
                                           VerticalAlignment="Center"
                                           Visibility="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=IsSelected, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                <TextBlock Grid.Column="1"
                                           Text="{Binding}"
                                           VerticalAlignment="Center"/>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
                <Button Content="Save" Command="{Binding SaveCommand}" Width="80" Margin="0,10,0,0"/>
            </StackPanel>
        </Border>

        <!-- Right: Selected Report Details -->
        <Border Grid.Column="2" Background="White" Padding="20" CornerRadius="10">
            <StackPanel>
                <TextBlock Text="Selected Report Name" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>
                <TextBox Text="{Binding SelectedFormat.Name}" IsReadOnly="True" Margin="0,0,0,10"/>
                <TextBlock Text="Selected Report Columns" FontSize="16" Margin="0,0,0,10"/>
                <ListBox ItemsSource="{Binding SelectedColumnsView}" SelectedItem="{Binding SelectedColumnToRemove}" Height="250"/>
                <!--<Button Content="Remove Column" Command="{Binding RemoveColumnCommand}" Width="120" Margin="0,10,0,0"/>-->
            </StackPanel>
        </Border>
    </Grid>
</UserControl>